{"version":3,"file":"100-bundle.js?3f7a8cc4f64b0cd82874","mappings":"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","sources":["webpack://recipe-me-webpack5/./src/helpers/imageOptimizer.js","webpack://recipe-me-webpack5/./src/helpers/imageGallery.js","webpack://recipe-me-webpack5/./src/helpers/globalImageRegistry.js","webpack://recipe-me-webpack5/./src/helpers/duplicateCheck.js"],"sourcesContent":["/**\r\n * Optimize image before uploading to Cloudinary\r\n * @param {File} file - Original image file\r\n * @param {Object} options - Resize options\r\n * @returns {Promise<Blob>} - Optimized image blob\r\n */\r\nexport async function optimizeImage(file, options = {}) {\r\n  const {\r\n    maxWidth = 1600,\r\n    maxHeight = 1600,\r\n    quality = 0.85,\r\n    format = 'image/jpeg'\r\n  } = options;\r\n\r\n  return new Promise((resolve, reject) => {\r\n    const reader = new FileReader();\r\n    \r\n    reader.onload = (e) => {\r\n      const img = new Image();\r\n      \r\n      img.onload = () => {\r\n        // Calculate new dimensions (maintain aspect ratio)\r\n        let width = img.width;\r\n        let height = img.height;\r\n        \r\n        if (width > maxWidth || height > maxHeight) {\r\n          const ratio = Math.min(maxWidth / width, maxHeight / height);\r\n          width = Math.round(width * ratio);\r\n          height = Math.round(height * ratio);\r\n        }\r\n        \r\n        // Create canvas\r\n        const canvas = document.createElement('canvas');\r\n        canvas.width = width;\r\n        canvas.height = height;\r\n        \r\n        // Draw resized image\r\n        const ctx = canvas.getContext('2d');\r\n        ctx.imageSmoothingEnabled = true;\r\n        ctx.imageSmoothingQuality = 'high';\r\n        ctx.drawImage(img, 0, 0, width, height);\r\n        \r\n        // Convert to blob\r\n        canvas.toBlob(\r\n          (blob) => {\r\n            if (blob) {\r\n              console.log(`âœ… Optimized: ${(file.size / 1024).toFixed(0)}KB â†’ ${(blob.size / 1024).toFixed(0)}KB`);\r\n              resolve(blob);\r\n            } else {\r\n              reject(new Error('Failed to optimize image'));\r\n            }\r\n          },\r\n          format,\r\n          quality\r\n        );\r\n      };\r\n      \r\n      img.onerror = () => reject(new Error('Failed to load image'));\r\n      img.src = e.target.result;\r\n    };\r\n    \r\n    reader.onerror = () => reject(new Error('Failed to read file'));\r\n    reader.readAsDataURL(file);\r\n  });\r\n}\r\n\r\n/**\r\n * Get recommended optimization settings for different image types\r\n */\r\nexport const IMAGE_PRESETS = {\r\n  avatar: {\r\n    maxWidth: 400,\r\n    maxHeight: 400,\r\n    quality: 0.90,\r\n    format: 'image/jpeg'\r\n  },\r\n  recipeHero: {\r\n    maxWidth: 1600,\r\n    maxHeight: 1600,\r\n    quality: 0.85,\r\n    format: 'image/jpeg'\r\n  },\r\n  recipeThumbnail: {\r\n    maxWidth: 800,\r\n    maxHeight: 800,\r\n    quality: 0.80,\r\n    format: 'image/jpeg'\r\n  }\r\n};","// src/helpers/imageGallery.js\r\nimport { v4 as uuidv4 } from 'uuid';\r\nimport { loadRecipes, saveRecipes } from '../functions.js';\r\nimport { optimizeImage, IMAGE_PRESETS } from './imageOptimizer.js';\r\nimport { generateFileHash, checkDuplicateByFilename } from './duplicateCheck.js';\r\nimport { findExistingImage, registerImage, unregisterImageFromRecipe, getImageRegistry } from './globalImageRegistry.js';\r\n\r\nconst CLOUDINARY_CLOUD_NAME = 'day1f5nz8';\r\nconst CLOUDINARY_UPLOAD_PRESET = 'recipe_images';\r\n\r\n/**\r\n * Setup image gallery with upload, ordering, and feature selection\r\n * @param {string} recipeId - Current recipe ID\r\n */\r\nexport function setupImageGallery(recipeId) {\r\n  const uploadInput = document.getElementById('cloudinary-upload');\r\n  \r\n  if (!uploadInput) {\r\n    console.warn('Image upload input not found');\r\n    return;\r\n  }\r\n\r\n  // Handle Cloudinary upload\r\n  uploadInput.addEventListener('change', async (e) => {\r\n    const file = e.target.files[0];\r\n    if (!file) return;\r\n\r\n    // âŒ Block video file uploads\r\n    if (file.type.startsWith('video/')) {\r\n      showUploadStatus('âŒ Video files not supported. Please upload to YouTube and paste the link instead.', 'error');\r\n      uploadInput.value = '';\r\n      return;\r\n    }\r\n\r\n    // Validate image type\r\n    if (!file.type.startsWith('image/')) {\r\n      showUploadStatus('Please select an image file', 'error');\r\n      uploadInput.value = '';\r\n      return;\r\n    }\r\n\r\n    // Validate original file size (allow up to 20MB originals)\r\n    if (file.size > 20 * 1024 * 1024) {\r\n      showUploadStatus('Image must be smaller than 20MB', 'error');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      showUploadStatus('Checking for duplicates...', 'uploading');\r\n      \r\n      // Optimize first (so hash matches what's stored)\r\n      const optimizedBlob = await optimizeImage(file, IMAGE_PRESETS.recipeHero);\r\n      \r\n      // âœ… Generate hash of optimized image\r\n      const fileHash = await generateFileHash(optimizedBlob);\r\n      \r\n      // âœ… Check GLOBAL registry (all recipes)\r\n      const existingImage = findExistingImage(fileHash);\r\n      \r\n      if (existingImage) {\r\n        const usedInRecipes = existingImage.usedByRecipes.length;\r\n        const shouldReuse = confirm(\r\n          `âœ… This image already exists!\\n\\n` +\r\n          `File: ${existingImage.metadata?.originalFilename || 'Unknown'}\\n` +\r\n          `Used in: ${usedInRecipes} recipe(s)\\n` +\r\n          `Uploaded: ${new Date(existingImage.uploadedAt).toLocaleDateString()}\\n\\n` +\r\n          `Reuse existing image? (Saves bandwidth & storage)`\r\n        );\r\n        \r\n        if (shouldReuse) {\r\n          // âœ… Reuse existing image\r\n          console.log('â™»ï¸ Reusing existing image:', existingImage.url);\r\n          \r\n          const imageData = {\r\n            url: existingImage.url,\r\n            source: 'user-upload',\r\n            cloudinaryPublicId: existingImage.cloudinaryPublicId,\r\n            fileHash: fileHash,\r\n            attribution: null,\r\n            metadata: {\r\n              uploadedAt: existingImage.uploadedAt,\r\n              originalFilename: file.name,\r\n              reusedFrom: existingImage.metadata?.originalFilename,\r\n              originalSize: file.size,\r\n              optimizedSize: optimizedBlob.size\r\n            }\r\n          };\r\n          \r\n          await addImageToRecipe(recipeId, imageData);\r\n          \r\n          // Register this recipe as using the image\r\n          registerImage(fileHash, existingImage, recipeId);\r\n          \r\n          await renderImageGallery(recipeId);\r\n          showUploadStatus('âœ“ Image reused! (No upload needed)', 'success');\r\n          uploadInput.value = '';\r\n          return;\r\n        }\r\n      }\r\n      \r\n      // Not reusing, check for duplicate by filename within this recipe\r\n      const recipes = await loadRecipes();\r\n      const recipe = recipes.find(r => r.id === recipeId);\r\n      \r\n      if (recipe && recipe.images) {\r\n        const duplicateByName = checkDuplicateByFilename(file.name, recipe.images);\r\n        \r\n        if (duplicateByName) {\r\n          const shouldContinue = confirm(\r\n            `âš ï¸ An image named \"${file.name}\" already exists in this recipe.\\n\\n` +\r\n            `Do you want to upload it anyway?`\r\n          );\r\n          \r\n          if (!shouldContinue) {\r\n            uploadInput.value = '';\r\n            showUploadStatus('Upload cancelled - duplicate detected', 'error');\r\n            return;\r\n          }\r\n        }\r\n      }\r\n      \r\n      // Proceed with new upload\r\n      const originalSize = (file.size / 1024).toFixed(0);\r\n      const optimizedSize = (optimizedBlob.size / 1024).toFixed(0);\r\n      const savings = Math.round((1 - optimizedBlob.size / file.size) * 100);\r\n      \r\n      console.log(`ðŸ“‰ Size reduction: ${originalSize}KB â†’ ${optimizedSize}KB (${savings}% smaller)`);\r\n      \r\n      showUploadStatus('Uploading optimized image...', 'uploading');\r\n      \r\n      // Upload to Cloudinary\r\n      const { url, publicId } = await uploadToCloudinary(optimizedBlob, file.name);\r\n      \r\n      const imageData = {\r\n        url,\r\n        source: 'user-upload',\r\n        cloudinaryPublicId: publicId,\r\n        fileHash: fileHash,\r\n        attribution: null,\r\n        metadata: {\r\n          uploadedAt: new Date().toISOString(),\r\n          originalFilename: file.name,\r\n          originalSize: file.size,\r\n          optimizedSize: optimizedBlob.size\r\n        }\r\n      };\r\n      \r\n      // âœ… Register in global registry\r\n      registerImage(fileHash, imageData, recipeId);\r\n      \r\n      // Add to recipe\r\n      await addImageToRecipe(recipeId, imageData);\r\n      \r\n      await renderImageGallery(recipeId);\r\n      showUploadStatus(`âœ“ Image added! (Saved ${savings}% bandwidth)`, 'success');\r\n      uploadInput.value = '';\r\n      \r\n    } catch (error) {\r\n      console.error('Upload failed:', error);\r\n      showUploadStatus(`âœ— Upload failed: ${error.message}`, 'error');\r\n    }\r\n  });\r\n\r\n  // Initial render\r\n  renderImageGallery(recipeId);\r\n}\r\n\r\n/**\r\n * Add image from Unsplash (called from featureImage.js)\r\n * ALWAYS includes attribution (Unsplash requirement)\r\n * @param {string} recipeId \r\n * @param {Object} imageData \r\n */\r\nexport async function addUnsplashImage(recipeId, imageData) {\r\n  await addImageToRecipe(recipeId, {\r\n    url: imageData.url,\r\n    source: 'unsplash',\r\n    cloudinaryPublicId: null,\r\n    attribution: {\r\n      photographer: imageData.photographer,\r\n      photographerUrl: imageData.photographerLink, // Includes UTM params\r\n      requiresAttribution: true,\r\n      canEdit: false // Cannot edit/remove Unsplash attribution\r\n    }\r\n  });\r\n  \r\n  await renderImageGallery(recipeId);\r\n}\r\n\r\n/**\r\n * Upload to Cloudinary - returns URL and publicId\r\n */\r\nasync function uploadToCloudinary(fileOrBlob, filename = 'image.jpg') {\r\n  const formData = new FormData();\r\n  \r\n  // Convert blob to file with proper name\r\n  if (fileOrBlob instanceof Blob && !(fileOrBlob instanceof File)) {\r\n    const file = new File([fileOrBlob], filename, { type: fileOrBlob.type });\r\n    formData.append('file', file);\r\n  } else {\r\n    formData.append('file', fileOrBlob);\r\n  }\r\n  \r\n  formData.append('upload_preset', CLOUDINARY_UPLOAD_PRESET);\r\n  formData.append('folder', 'recipes');\r\n\r\n  const response = await fetch(\r\n    `https://api.cloudinary.com/v1_1/${CLOUDINARY_CLOUD_NAME}/image/upload`,\r\n    {\r\n      method: 'POST',\r\n      body: formData\r\n    }\r\n  );\r\n\r\n  if (!response.ok) {\r\n    const error = await response.json();\r\n    throw new Error(error.error?.message || 'Upload failed');\r\n  }\r\n\r\n  const data = await response.json();\r\n  \r\n  return {\r\n    url: data.secure_url.replace('/upload/', '/upload/q_auto,f_auto/'),\r\n    publicId: data.public_id\r\n  };\r\n}\r\n\r\n/**\r\n * Add image to recipe\r\n */\r\nasync function addImageToRecipe(recipeId, imageData) {\r\n  const recipes = await loadRecipes();\r\n  const recipe = recipes.find(r => r.id === recipeId);\r\n  if (!recipe) return;\r\n\r\n  // Initialize images array if needed\r\n  if (!recipe.images) {\r\n    recipe.images = [];\r\n  }\r\n\r\n  // Create new image object\r\n  const newImage = {\r\n    id: uuidv4(),\r\n    url: imageData.url,\r\n    source: imageData.source,\r\n    isFeatured: recipe.images.length === 0, // First image is featured\r\n    order: recipe.images.length,\r\n    cloudinaryPublicId: imageData.cloudinaryPublicId || null,\r\n    fileHash: imageData.fileHash || null,\r\n    attribution: imageData.attribution || null,\r\n    metadata: imageData.metadata || null\r\n  };\r\n\r\n  recipe.images.push(newImage);\r\n  recipe.updatedAt = new Date().toISOString();\r\n  \r\n  saveRecipes(recipes);\r\n  localStorage.setItem('editingRecipe', JSON.stringify(recipe));\r\n}\r\n\r\n/**\r\n * Render the image gallery\r\n */\r\nexport async function renderImageGallery(recipeId) {\r\n  const recipes = await loadRecipes();\r\n  const recipe = recipes.find(r => r.id === recipeId);\r\n  const gallery = document.getElementById('image-gallery');\r\n  const noImagesMsg = gallery?.querySelector('.no-images');\r\n  \r\n  if (!recipe || !gallery) return;\r\n\r\n  // Show/hide no images message\r\n  if (!recipe.images || recipe.images.length === 0) {\r\n    if (noImagesMsg) noImagesMsg.style.display = 'block';\r\n    gallery.innerHTML = '<p class=\"no-images\">No images yet. Upload or search to add images.</p>';\r\n    return;\r\n  }\r\n\r\n  if (noImagesMsg) noImagesMsg.style.display = 'none';\r\n\r\n  // Sort images by order\r\n  const sortedImages = [...recipe.images].sort((a, b) => a.order - b.order);\r\n\r\n  gallery.innerHTML = `\r\n    ${sortedImages.map(img => `\r\n      <div class=\"image-card\" data-image-id=\"${img.id}\" draggable=\"true\">\r\n        <div class=\"image-preview\">\r\n          <img src=\"${img.url}\" alt=\"Recipe image\">\r\n          ${img.isFeatured ? '<div class=\"featured-badge\"><i class=\"fa-solid fa-star\"></i> Featured</div>' : ''}\r\n          \r\n          ${img.source === 'unsplash' ? `\r\n            <div class=\"source-badge unsplash-badge\" title=\"From Unsplash\">\r\n              <i class=\"fa-solid fa-image\"></i> Unsplash\r\n            </div>\r\n          ` : img.attribution ? `\r\n            <div class=\"source-badge attribution-badge\" title=\"${formatAttributionText(img)}\">\r\n              <i class=\"fa-solid fa-copyright\"></i> Credit\r\n            </div>\r\n          ` : img.metadata?.reusedFrom ? `\r\n            <div class=\"source-badge reused-badge\" title=\"Reused from: ${img.metadata.reusedFrom}\">\r\n              <i class=\"fa-solid fa-recycle\"></i> Reused\r\n            </div>\r\n          ` : ''}\r\n        </div>\r\n        \r\n        <div class=\"image-actions\">\r\n          <button \r\n            class=\"btn-small ${img.isFeatured ? 'active' : ''}\" \r\n            onclick=\"window.setFeaturedImage('${recipeId}', '${img.id}')\"\r\n            title=\"Set as featured image\"\r\n          >\r\n            <i class=\"fa-solid fa-star\"></i>\r\n          </button>\r\n          \r\n          <button \r\n            class=\"btn-small\" \r\n            onclick=\"window.moveImageUp('${recipeId}', '${img.id}')\"\r\n            title=\"Move up\"\r\n            ${img.order === 0 ? 'disabled' : ''}\r\n          >\r\n            <i class=\"fa-solid fa-arrow-up\"></i>\r\n          </button>\r\n          \r\n          <button \r\n            class=\"btn-small\" \r\n            onclick=\"window.moveImageDown('${recipeId}', '${img.id}')\"\r\n            title=\"Move down\"\r\n            ${img.order === sortedImages.length - 1 ? 'disabled' : ''}\r\n          >\r\n            <i class=\"fa-solid fa-arrow-down\"></i>\r\n          </button>\r\n          \r\n          <button \r\n            class=\"btn-small ${img.attribution ? 'has-attribution' : ''}\" \r\n            onclick=\"window.editAttribution('${recipeId}', '${img.id}')\"\r\n            title=\"${img.source === 'unsplash' ? 'Unsplash attribution (required)' : img.attribution ? 'Edit attribution' : 'Add attribution'}\"\r\n            ${img.source === 'unsplash' ? 'disabled' : ''}\r\n          >\r\n            <i class=\"fa-solid fa-${img.source === 'unsplash' ? 'lock' : 'copyright'}\"></i>\r\n          </button>\r\n          \r\n          <button \r\n            class=\"btn-small btn-danger\" \r\n            onclick=\"window.removeImage('${recipeId}', '${img.id}')\"\r\n            title=\"Remove image\"\r\n          >\r\n            <i class=\"fa-solid fa-trash\"></i>\r\n          </button>\r\n        </div>\r\n        \r\n        ${img.source === 'unsplash' || img.attribution ? `\r\n          <div class=\"image-credit ${img.source === 'unsplash' ? 'unsplash-credit' : ''}\">\r\n            ${formatAttribution(img)}\r\n          </div>\r\n        ` : ''}\r\n      </div>\r\n    `).join('')}\r\n  `;\r\n\r\n  // Setup drag-and-drop for reordering\r\n  setupDragAndDrop(recipeId);\r\n}\r\n\r\n/**\r\n * Format attribution for display (Unsplash-compliant)\r\n */\r\nfunction formatAttribution(image) {\r\n  if (!image.attribution) return '';\r\n  \r\n  const attr = image.attribution;\r\n  \r\n  // Unsplash-specific format (required by their guidelines)\r\n  if (image.source === 'unsplash') {\r\n    return `Photo by <a href=\"${attr.photographerUrl}\" target=\"_blank\" rel=\"noopener\">${attr.photographer}</a> on <a href=\"https://unsplash.com/?utm_source=recipe_me&utm_medium=referral\" target=\"_blank\" rel=\"noopener\">Unsplash</a>`;\r\n  }\r\n  \r\n  // User-added attribution\r\n  if (attr.customCredit) {\r\n    return attr.customCredit;\r\n  }\r\n  \r\n  let text = `Photo by ${attr.photographer}`;\r\n  \r\n  if (attr.photographerUrl) {\r\n    text = `<a href=\"${attr.photographerUrl}\" target=\"_blank\" rel=\"noopener\">${text}</a>`;\r\n  }\r\n  \r\n  return text;\r\n}\r\n\r\n/**\r\n * Format attribution as plain text (for title attribute)\r\n */\r\nfunction formatAttributionText(image) {\r\n  if (!image.attribution) return '';\r\n  \r\n  const attr = image.attribution;\r\n  \r\n  if (image.source === 'unsplash') {\r\n    return `Photo by ${attr.photographer} on Unsplash`;\r\n  }\r\n  \r\n  if (attr.customCredit) {\r\n    return attr.customCredit;\r\n  }\r\n  \r\n  return `Photo by ${attr.photographer}`;\r\n}\r\n\r\n/**\r\n * Edit attribution (only for user uploads, not Unsplash)\r\n */\r\nwindow.editAttribution = async function(recipeId, imageId) {\r\n  const recipes = await loadRecipes();\r\n  const recipe = recipes.find(r => r.id === recipeId);\r\n  const image = recipe?.images?.find(img => img.id === imageId);\r\n  \r\n  if (!image) return;\r\n  \r\n  // Block editing Unsplash attribution\r\n  if (image.source === 'unsplash') {\r\n    alert('Unsplash attribution cannot be edited or removed per their terms of use.');\r\n    return;\r\n  }\r\n  \r\n  const attribution = await showAttributionDialog(image.attribution);\r\n  \r\n  if (attribution !== undefined) { // undefined = cancelled\r\n    image.attribution = attribution;\r\n    recipe.updatedAt = new Date().toISOString();\r\n    saveRecipes(recipes);\r\n    localStorage.setItem('editingRecipe', JSON.stringify(recipe));\r\n    await renderImageGallery(recipeId);\r\n  }\r\n};\r\n\r\n/**\r\n * Show attribution dialog\r\n */\r\nfunction showAttributionDialog(currentAttribution) {\r\n  return new Promise((resolve) => {\r\n    const dialog = document.createElement('dialog');\r\n    dialog.className = 'attribution-dialog modal-dialog';\r\n    \r\n    const hasAttribution = currentAttribution && currentAttribution.photographer;\r\n    \r\n    dialog.innerHTML = `\r\n      <form id=\"attribution-form\">\r\n        <h3>${hasAttribution ? 'Edit' : 'Add'} Image Attribution</h3>\r\n        <p class=\"hint\">Optional - add credit if this photo is from a photographer or requires attribution.</p>\r\n        \r\n        <div class=\"form-group\">\r\n          <label for=\"photographer-name\">Photographer/Source Name:</label>\r\n          <input \r\n            type=\"text\" \r\n            id=\"photographer-name\" \r\n            placeholder=\"e.g., Jane Smith Photography\"\r\n            value=\"${currentAttribution?.photographer || ''}\"\r\n          >\r\n        </div>\r\n        \r\n        <div class=\"form-group\">\r\n          <label for=\"photographer-url\">Website/URL (optional):</label>\r\n          <input \r\n            type=\"url\" \r\n            id=\"photographer-url\" \r\n            placeholder=\"https://janesmith.com\"\r\n            value=\"${currentAttribution?.photographerUrl || ''}\"\r\n          >\r\n        </div>\r\n        \r\n        <div class=\"form-group\">\r\n          <label for=\"custom-credit\">Custom Credit Line (optional):</label>\r\n          <input \r\n            type=\"text\" \r\n            id=\"custom-credit\" \r\n            placeholder=\"e.g., Photography by Jane Smith\"\r\n            value=\"${currentAttribution?.customCredit || ''}\"\r\n          >\r\n          <small>If blank, will auto-generate from photographer name</small>\r\n        </div>\r\n        \r\n        <div class=\"button-group\">\r\n          ${hasAttribution ? `\r\n            <button type=\"button\" id=\"remove-attribution-btn\" class=\"btn-secondary\">\r\n              Remove Attribution\r\n            </button>\r\n          ` : ''}\r\n          <button type=\"button\" id=\"cancel-btn\" class=\"btn-secondary\">\r\n            Cancel\r\n          </button>\r\n          <button type=\"submit\" class=\"btn-primary\">\r\n            Save\r\n          </button>\r\n        </div>\r\n      </form>\r\n    `;\r\n    \r\n    document.body.appendChild(dialog);\r\n    dialog.showModal();\r\n    \r\n    const form = dialog.querySelector('#attribution-form');\r\n    const photographerInput = dialog.querySelector('#photographer-name');\r\n    const urlInput = dialog.querySelector('#photographer-url');\r\n    const creditInput = dialog.querySelector('#custom-credit');\r\n    const cancelBtn = dialog.querySelector('#cancel-btn');\r\n    const removeBtn = dialog.querySelector('#remove-attribution-btn');\r\n    \r\n    photographerInput.focus();\r\n    \r\n    cancelBtn.addEventListener('click', () => {\r\n      dialog.close();\r\n      dialog.remove();\r\n      resolve(undefined); // undefined = cancelled\r\n    });\r\n    \r\n    if (removeBtn) {\r\n      removeBtn.addEventListener('click', () => {\r\n        if (confirm('Remove attribution from this image?')) {\r\n          dialog.close();\r\n          dialog.remove();\r\n          resolve(null); // null = remove attribution\r\n        }\r\n      });\r\n    }\r\n    \r\n    dialog.addEventListener('click', (e) => {\r\n      if (e.target === dialog) {\r\n        dialog.close();\r\n        dialog.remove();\r\n        resolve(undefined);\r\n      }\r\n    });\r\n    \r\n    form.addEventListener('submit', (e) => {\r\n      e.preventDefault();\r\n      \r\n      const photographer = photographerInput.value.trim();\r\n      const url = urlInput.value.trim();\r\n      const customCredit = creditInput.value.trim();\r\n      \r\n      if (!photographer) {\r\n        dialog.close();\r\n        dialog.remove();\r\n        resolve(null); // No photographer = remove attribution\r\n        return;\r\n      }\r\n      \r\n      const attribution = {\r\n        photographer,\r\n        photographerUrl: url || null,\r\n        customCredit: customCredit || null,\r\n        requiresAttribution: true,\r\n        canEdit: true\r\n      };\r\n      \r\n      dialog.close();\r\n      dialog.remove();\r\n      resolve(attribution);\r\n    });\r\n  });\r\n}\r\n\r\n/**\r\n * Set featured image\r\n */\r\nwindow.setFeaturedImage = async function(recipeId, imageId) {\r\n  const recipes = await loadRecipes();\r\n  const recipe = recipes.find(r => r.id === recipeId);\r\n  if (!recipe || !recipe.images) return;\r\n\r\n  recipe.images.forEach(img => img.isFeatured = false);\r\n  const image = recipe.images.find(img => img.id === imageId);\r\n  if (image) image.isFeatured = true;\r\n\r\n  recipe.updatedAt = new Date().toISOString();\r\n  saveRecipes(recipes);\r\n  localStorage.setItem('editingRecipe', JSON.stringify(recipe));\r\n  \r\n  await renderImageGallery(recipeId);\r\n};\r\n\r\n/**\r\n * Move image up\r\n */\r\nwindow.moveImageUp = async function(recipeId, imageId) {\r\n  const recipes = await loadRecipes();\r\n  const recipe = recipes.find(r => r.id === recipeId);\r\n  if (!recipe || !recipe.images) return;\r\n\r\n  const index = recipe.images.findIndex(img => img.id === imageId);\r\n  if (index <= 0) return;\r\n\r\n  const temp = recipe.images[index].order;\r\n  recipe.images[index].order = recipe.images[index - 1].order;\r\n  recipe.images[index - 1].order = temp;\r\n\r\n  recipe.updatedAt = new Date().toISOString();\r\n  saveRecipes(recipes);\r\n  localStorage.setItem('editingRecipe', JSON.stringify(recipe));\r\n  \r\n  await renderImageGallery(recipeId);\r\n};\r\n\r\n/**\r\n * Move image down\r\n */\r\nwindow.moveImageDown = async function(recipeId, imageId) {\r\n  const recipes = await loadRecipes();\r\n  const recipe = recipes.find(r => r.id === recipeId);\r\n  if (!recipe || !recipe.images) return;\r\n\r\n  const index = recipe.images.findIndex(img => img.id === imageId);\r\n  if (index === -1 || index >= recipe.images.length - 1) return;\r\n\r\n  const temp = recipe.images[index].order;\r\n  recipe.images[index].order = recipe.images[index + 1].order;\r\n  recipe.images[index + 1].order = temp;\r\n\r\n  recipe.updatedAt = new Date().toISOString();\r\n  saveRecipes(recipes);\r\n  localStorage.setItem('editingRecipe', JSON.stringify(recipe));\r\n  \r\n  await renderImageGallery(recipeId);\r\n};\r\n\r\n/**\r\n * Remove image\r\n */\r\nwindow.removeImage = async function(recipeId, imageId) {\r\n  if (!confirm('Remove this image? This cannot be undone.')) return;\r\n\r\n  const recipes = await loadRecipes();\r\n  const recipe = recipes.find(r => r.id === recipeId);\r\n  if (!recipe || !recipe.images) return;\r\n\r\n  const imageToRemove = recipe.images.find(img => img.id === imageId);\r\n  \r\n  // âœ… Unregister from global registry\r\n  if (imageToRemove?.fileHash) {\r\n    unregisterImageFromRecipe(imageToRemove.fileHash, recipeId);\r\n  }\r\n  \r\n  // Check if other recipes still use this image\r\n  const registry = getImageRegistry();\r\n  const imageData = registry[imageToRemove?.fileHash];\r\n  const stillInUse = imageData?.usedByRecipes.length > 0;\r\n  \r\n  // Only delete from Cloudinary if no other recipe uses it\r\n  if (!stillInUse && imageToRemove?.source === 'user-upload' && imageToRemove.cloudinaryPublicId) {\r\n    const shouldDelete = confirm(\r\n      'This image is not used by any other recipe.\\n\\n' +\r\n      'Delete from Cloudinary? (Saves storage)'\r\n    );\r\n    \r\n    if (shouldDelete) {\r\n      showUploadStatus('Deleting from Cloudinary...', 'uploading');\r\n      // TODO: Implement Cloudinary deletion\r\n      // await deleteFromCloudinary(imageToRemove.cloudinaryPublicId);\r\n      console.log('ðŸ—‘ï¸ Would delete:', imageToRemove.cloudinaryPublicId);\r\n    }\r\n  } else if (stillInUse) {\r\n    console.log(`â™»ï¸ Image still used by ${imageData.usedByRecipes.length} recipe(s), keeping in Cloudinary`);\r\n  }\r\n\r\n  // Remove from recipe\r\n  recipe.images = recipe.images.filter(img => img.id !== imageId);\r\n  \r\n  // Reorder remaining images\r\n  recipe.images.sort((a, b) => a.order - b.order);\r\n  recipe.images.forEach((img, index) => img.order = index);\r\n\r\n  // If removed image was featured, set first image as featured\r\n  if (recipe.images.length > 0 && !recipe.images.some(img => img.isFeatured)) {\r\n    recipe.images[0].isFeatured = true;\r\n  }\r\n\r\n  recipe.updatedAt = new Date().toISOString();\r\n  saveRecipes(recipes);\r\n  localStorage.setItem('editingRecipe', JSON.stringify(recipe));\r\n  \r\n  await renderImageGallery(recipeId);\r\n  showUploadStatus('Image removed', 'success');\r\n};\r\n\r\n/**\r\n * Setup drag-and-drop reordering\r\n */\r\nfunction setupDragAndDrop(recipeId) {\r\n  const imageCards = document.querySelectorAll('.image-card');\r\n  let draggedElement = null;\r\n\r\n  imageCards.forEach(card => {\r\n    card.addEventListener('dragstart', (e) => {\r\n      draggedElement = card;\r\n      card.classList.add('dragging');\r\n    });\r\n\r\n    card.addEventListener('dragend', () => {\r\n      card.classList.remove('dragging');\r\n    });\r\n\r\n    card.addEventListener('dragover', (e) => {\r\n      e.preventDefault();\r\n      const afterElement = getDragAfterElement(card.parentElement, e.clientY);\r\n      if (afterElement == null) {\r\n        card.parentElement.appendChild(draggedElement);\r\n      } else {\r\n        card.parentElement.insertBefore(draggedElement, afterElement);\r\n      }\r\n    });\r\n\r\n    card.addEventListener('drop', async (e) => {\r\n      e.preventDefault();\r\n      await reorderImagesAfterDrag(recipeId);\r\n    });\r\n  });\r\n}\r\n\r\n/**\r\n * Get element to insert dragged item after\r\n */\r\nfunction getDragAfterElement(container, y) {\r\n  const draggableElements = [...container.querySelectorAll('.image-card:not(.dragging)')];\r\n\r\n  return draggableElements.reduce((closest, child) => {\r\n    const box = child.getBoundingClientRect();\r\n    const offset = y - box.top - box.height / 2;\r\n\r\n    if (offset < 0 && offset > closest.offset) {\r\n      return { offset: offset, element: child };\r\n    } else {\r\n      return closest;\r\n    }\r\n  }, { offset: Number.NEGATIVE_INFINITY }).element;\r\n}\r\n\r\n/**\r\n * Save new order after drag-and-drop\r\n */\r\nasync function reorderImagesAfterDrag(recipeId) {\r\n  const recipes = await loadRecipes();\r\n  const recipe = recipes.find(r => r.id === recipeId);\r\n  if (!recipe || !recipe.images) return;\r\n\r\n  const imageCards = document.querySelectorAll('.image-card');\r\n  const newOrder = Array.from(imageCards).map(card => card.dataset.imageId);\r\n\r\n  newOrder.forEach((imageId, index) => {\r\n    const img = recipe.images.find(i => i.id === imageId);\r\n    if (img) img.order = index;\r\n  });\r\n\r\n  recipe.updatedAt = new Date().toISOString();\r\n  saveRecipes(recipes);\r\n  localStorage.setItem('editingRecipe', JSON.stringify(recipe));\r\n}\r\n\r\n/**\r\n * Show upload status\r\n */\r\nfunction showUploadStatus(message, type) {\r\n  const statusDiv = document.getElementById('upload-status');\r\n  if (!statusDiv) return;\r\n\r\n  statusDiv.textContent = message;\r\n  statusDiv.className = `upload-status-${type}`;\r\n\r\n  if (type === 'success' || type === 'error') {\r\n    setTimeout(() => {\r\n      statusDiv.textContent = '';\r\n      statusDiv.className = '';\r\n    }, 3000);\r\n  }\r\n}","// src/helpers/globalImageRegistry.js\r\n\r\n/**\r\n * Global image registry for deduplication across all recipes\r\n * Structure:\r\n * {\r\n *   \"hash123\": {\r\n *     url: \"https://cloudinary.com/.../image.jpg\",\r\n *     cloudinaryPublicId: \"recipes/abc123\",\r\n *     uploadedAt: \"2025-12-18T10:30:00Z\",\r\n *     usedByRecipes: [\"recipe-1\", \"recipe-2\"],\r\n *     metadata: { originalFilename: \"placeholder.jpg\", size: 524288 }\r\n *   }\r\n * }\r\n */\r\n\r\nconst REGISTRY_KEY = 'imageRegistry';\r\n\r\n/**\r\n * Get the global image registry\r\n */\r\nexport function getImageRegistry() {\r\n  try {\r\n    const data = localStorage.getItem(REGISTRY_KEY);\r\n    return data ? JSON.parse(data) : {};\r\n  } catch (error) {\r\n    console.error('Failed to load image registry:', error);\r\n    return {};\r\n  }\r\n}\r\n\r\n/**\r\n * Save the global image registry\r\n */\r\nexport function saveImageRegistry(registry) {\r\n  try {\r\n    localStorage.setItem(REGISTRY_KEY, JSON.stringify(registry));\r\n  } catch (error) {\r\n    console.error('Failed to save image registry:', error);\r\n  }\r\n}\r\n\r\n/**\r\n * Check if image already exists globally (across all recipes)\r\n * @param {string} fileHash - SHA-256 hash of file\r\n * @returns {Object|null} - Image data if exists, null otherwise\r\n */\r\nexport function findExistingImage(fileHash) {\r\n  const registry = getImageRegistry();\r\n  return registry[fileHash] || null;\r\n}\r\n\r\n/**\r\n * Register a new uploaded image\r\n * @param {string} fileHash - SHA-256 hash of file\r\n * @param {Object} imageData - Image data (url, cloudinaryPublicId, etc.)\r\n * @param {string} recipeId - Recipe ID using this image\r\n */\r\nexport function registerImage(fileHash, imageData, recipeId) {\r\n  const registry = getImageRegistry();\r\n  \r\n  if (registry[fileHash]) {\r\n    // Image already exists, add this recipe to usage list\r\n    if (!registry[fileHash].usedByRecipes.includes(recipeId)) {\r\n      registry[fileHash].usedByRecipes.push(recipeId);\r\n      registry[fileHash].lastUsedAt = new Date().toISOString();\r\n    }\r\n  } else {\r\n    // New image, register it\r\n    registry[fileHash] = {\r\n      ...imageData,\r\n      uploadedAt: new Date().toISOString(),\r\n      lastUsedAt: new Date().toISOString(),\r\n      usedByRecipes: [recipeId]\r\n    };\r\n  }\r\n  \r\n  saveImageRegistry(registry);\r\n}\r\n\r\n/**\r\n * Remove recipe from image usage (when image removed from recipe)\r\n * @param {string} fileHash - SHA-256 hash of file\r\n * @param {string} recipeId - Recipe ID to remove\r\n */\r\nexport function unregisterImageFromRecipe(fileHash, recipeId) {\r\n  const registry = getImageRegistry();\r\n  \r\n  if (registry[fileHash]) {\r\n    registry[fileHash].usedByRecipes = registry[fileHash].usedByRecipes.filter(\r\n      id => id !== recipeId\r\n    );\r\n    \r\n    // If no recipes use this image anymore, you could optionally delete from Cloudinary\r\n    // (but keeping it is safer in case of orphaned references)\r\n    \r\n    saveImageRegistry(registry);\r\n  }\r\n}\r\n\r\n/**\r\n * Get statistics about global image usage\r\n */\r\nexport function getImageStats() {\r\n  const registry = getImageRegistry();\r\n  const images = Object.values(registry);\r\n  \r\n  return {\r\n    totalImages: images.length,\r\n    totalUsage: images.reduce((sum, img) => sum + img.usedByRecipes.length, 0),\r\n    sharedImages: images.filter(img => img.usedByRecipes.length > 1).length,\r\n    orphanedImages: images.filter(img => img.usedByRecipes.length === 0).length\r\n  };\r\n}\r\n\r\n/**\r\n * Clean up orphaned images (not used by any recipe)\r\n */\r\nexport function cleanupOrphanedImages() {\r\n  const registry = getImageRegistry();\r\n  const cleaned = {};\r\n  \r\n  Object.entries(registry).forEach(([hash, imageData]) => {\r\n    if (imageData.usedByRecipes.length > 0) {\r\n      cleaned[hash] = imageData;\r\n    } else {\r\n      console.log('ðŸ—‘ï¸ Orphaned image:', imageData.metadata?.originalFilename);\r\n    }\r\n  });\r\n  \r\n  saveImageRegistry(cleaned);\r\n  \r\n  return {\r\n    before: Object.keys(registry).length,\r\n    after: Object.keys(cleaned).length,\r\n    removed: Object.keys(registry).length - Object.keys(cleaned).length\r\n  };\r\n}","// src/helpers/duplicateCheck.js\r\n\r\n/**\r\n * Generate hash from file for duplicate detection\r\n * @param {File|Blob} file\r\n * @returns {Promise<string>} - Hash string\r\n */\r\nexport async function generateFileHash(file) {\r\n  const arrayBuffer = await file.arrayBuffer();\r\n  const hashBuffer = await crypto.subtle.digest('SHA-256', arrayBuffer);\r\n  const hashArray = Array.from(new Uint8Array(hashBuffer));\r\n  const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');\r\n  return hashHex;\r\n}\r\n\r\n/**\r\n * Check if image already uploaded\r\n * @param {File|Blob} file\r\n * @param {Array} existingImages - Recipe's images array\r\n * @returns {Promise<Object|null>} - Existing image if found, null otherwise\r\n */\r\nexport async function checkForDuplicate(file, existingImages) {\r\n  if (!existingImages || existingImages.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  const fileHash = await generateFileHash(file);\r\n  \r\n  // Check if any existing image has this hash\r\n  const duplicate = existingImages.find(img => img.fileHash === fileHash);\r\n  \r\n  return duplicate || null;\r\n}\r\n\r\n/**\r\n * Check by filename (simpler but less accurate)\r\n * @param {string} filename\r\n * @param {Array} existingImages\r\n * @returns {Object|null}\r\n */\r\nexport function checkDuplicateByFilename(filename, existingImages) {\r\n  if (!existingImages || existingImages.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  // Normalize filename (remove path, spaces, special chars)\r\n  const normalizedName = filename.toLowerCase().trim().replace(/\\s+/g, '-');\r\n  \r\n  const duplicate = existingImages.find(img => {\r\n    if (img.metadata?.originalFilename) {\r\n      const existingName = img.metadata.originalFilename.toLowerCase().trim().replace(/\\s+/g, '-');\r\n      return existingName === normalizedName;\r\n    }\r\n    return false;\r\n  });\r\n  \r\n  return duplicate || null;\r\n}"],"names":["e","t","r","Symbol","n","iterator","o","toStringTag","i","c","prototype","Generator","u","Object","create","_regeneratorDefine2","f","p","y","G","v","a","d","bind","length","l","TypeError","call","done","value","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","m","defineProperty","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","optimizeImage","_x","_optimizeImage","apply","arguments","_callee","file","options","_options$maxWidth","maxWidth","_options$maxHeight","maxHeight","_options$quality","quality","_options$format","format","_args","_context","undefined","reject","reader","FileReader","onload","img","Image","width","height","ratio","Math","min","round","canvas","document","createElement","ctx","getContext","imageSmoothingEnabled","imageSmoothingQuality","drawImage","toBlob","blob","console","log","concat","size","toFixed","Error","onerror","src","target","result","readAsDataURL","_next","_throw","IMAGE_PRESETS","avatar","recipeHero","recipeThumbnail","_asyncToGenerator","setupImageGallery","recipeId","uploadInput","getElementById","addEventListener","_ref","optimizedBlob","fileHash","existingImage","_existingImage$metada","usedInRecipes","_existingImage$metada2","_imageData","recipes","recipe","originalSize","optimizedSize","savings","_yield$uploadToCloudi","url","publicId","imageData","_t","files","type","startsWith","showUploadStatus","generateFileHash","findExistingImage","usedByRecipes","confirm","metadata","originalFilename","Date","uploadedAt","toLocaleDateString","source","cloudinaryPublicId","attribution","name","reusedFrom","addImageToRecipe","registerImage","renderImageGallery","loadRecipes","find","id","images","checkDuplicateByFilename","uploadToCloudinary","toISOString","error","message","warn","addUnsplashImage","_x2","_x3","_addUnsplashImage","_callee8","_context8","photographer","photographerUrl","photographerLink","requiresAttribution","canEdit","_x4","_uploadToCloudinary","_callee9","fileOrBlob","filename","formData","response","_error$error","data","_args9","_context9","FormData","Blob","File","append","fetch","method","body","ok","json","secure_url","replace","public_id","_x5","_x6","_addImageToRecipe","_callee0","newImage","_context0","uuidv4","isFeatured","order","push","updatedAt","saveRecipes","localStorage","setItem","JSON","stringify","_x7","_renderImageGallery","_callee1","gallery","noImagesMsg","sortedImages","_context1","querySelector","style","display","innerHTML","_toConsumableArray","sort","b","map","_img$metadata","formatAttributionText","formatAttribution","join","setupDragAndDrop","image","attr","customCredit","text","showAttributionDialog","currentAttribution","dialog","className","hasAttribution","appendChild","showModal","form","photographerInput","urlInput","creditInput","cancelBtn","removeBtn","focus","close","remove","preventDefault","trim","imageCards","querySelectorAll","draggedElement","forEach","card","classList","add","container","afterElement","parentElement","clientY","reduce","closest","child","box","getBoundingClientRect","offset","top","element","Number","NEGATIVE_INFINITY","insertBefore","_ref7","_callee7","_context7","reorderImagesAfterDrag","_x16","_x17","_reorderImagesAfterDrag","_callee10","_context10","Array","from","dataset","imageId","index","statusDiv","textContent","setTimeout","window","editAttribution","_ref2","_callee2","_recipe$images","_context2","alert","_x8","_x9","setFeaturedImage","_ref3","_callee3","_context3","_x0","_x1","moveImageUp","_ref4","_callee4","temp","_context4","findIndex","_x10","_x11","moveImageDown","_ref5","_callee5","_context5","_x12","_x13","removeImage","_ref6","_callee6","imageToRemove","registry","stillInUse","_context6","unregisterImageFromRecipe","getImageRegistry","filter","some","_x14","_x15","REGISTRY_KEY","getItem","parse","saveImageRegistry","includes","lastUsedAt","_objectSpread","_generateFileHash","arrayBuffer","hashBuffer","hashArray","hashHex","crypto","subtle","digest","Uint8Array","toString","padStart","existingImages","normalizedName","toLowerCase"],"sourceRoot":""}